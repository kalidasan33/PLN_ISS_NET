@using ISS.Core.Model.Textiles;
@using Kendo.Mvc.UI;
@using Kendo.Mvc.UI.Fluent;
@using ISS.Common;

@model  System.Data.DataTable
@*<div class="btnContainer floatRight">
    <input type="submit" id="btnHeadsizeAllocationExport" class="excel_btn" name="gridValue" value="headsize" />
</div>
<br /><br />*@

@(Html.Kendo().Grid(Model)
                  .Name("grdHeadSize").HtmlAttributes(new { @class = "kgridheight" })
              .Columns(columns =>
               {
                   foreach (System.Data.DataColumn column in Model.Columns)
                   {
                       var c = columns.Bound(column.DataType, column.ColumnName).Width(Model.Columns.Count > 8 ? LOVConstants.Width.Small2B : LOVConstants.Width.Medium1);
                       
                       if ((column.ColumnName == "HeadSize" || column.ColumnName == "PlantCut") && Model.Columns.Count > 10)
                       {
                           c.Column.Locked = true;
                       }
                       if (column.ColumnName == "PlantCut")
                       {
                           c.Title("Plant/Cut");
                       }
                       if (column.ColumnName.Contains("_"))
                       {
                           c.Title(column.ColumnName.Substring(1));
                           c.HtmlAttributes(new { @class = "ob-right" });
                       }
                       if(column.ColumnName == "Total")
                       {
                           c.HtmlAttributes(new { @class = "ob-right" });

                       }

                       if ((column.ColumnName != "HeadSize" && column.ColumnName != "PlantCut" && column.ColumnName != "Total"))
                       {
                           c.ClientTemplate("<a data-headsize=" + column.ColumnName + " class='linki2 lnkTextiles'  href='javascript:void(0)' > #if (" + (column.ColumnName) + " == null) {# #=''# #} else {# #=" + (column.ColumnName) + "# #}# </a>");    
                       }
                   }
               }
                    )
                .Scrollable(scroll =>
                {
                    scroll.Enabled(true);
                    scroll.Height("auto");
                })
                     .ToolBar(toolbar =>
                              {
                                  toolbar.Excel();
                              })
                    .Excel(excel => excel
                                   .FileName("TextileHeadSizeAllocations" + DateTime.Now.ToString("yyyyMMddHHmmss") + ".xlsx")
                                   .Filterable(true)
                                   .AllPages(true)
                           )
                .Resizable(resizing => resizing.Columns(true))
                .DataSource(dataSource => dataSource
                    .Ajax()
                    .Model(model =>
                            {
                                foreach (System.Data.DataColumn column in Model.Columns)
                                {
                                    model.Field(column.ColumnName, column.DataType);
                                }
                            })
                    .ServerOperation(false)
                    
                )
               .Events(ev => ev.DataBound("textiles.onTextileGridDataBound").ExcelExport("textiles.exportHeadSizekendo"))
)
